
    

<div class="container-general">
    <?php
        session_start();
        echo '<div class="title-profil"><h1 >Profil de ' .$_SESSION['prenom'] .'</h1></div>';

       ?>
    <div class="cont-calculateur">
      <div class="cont-form">
        <form id="registrationForm">
            <div class="form-group">
                <label for="nom">Nom :</label>
                <?php 
                echo '<input type="text" name="nom" placeholder="Nom" value="' . (isset($_SESSION['nom']) ? $_SESSION['nom'] : '') . '" class="form-control">'; 
                ?>
            </div>

            <div class="form-group">  
                <label for="prenom">Prénom :</label>
                <?php 
                echo '<input type="text" name="prenom" placeholder="Prénom" value="' . (isset($_SESSION['prenom']) ? $_SESSION['prenom'] : '') . '" class="form-control">'; 
                ?>
            </div>

            <div class="form-group">
                <label for="age">Age :</label>
                <?php 
                echo '<input type="number" name="age" id="age" value="' . (isset($_SESSION['age']) ? $_SESSION['age'] : '') . '" class="form-control">'; 
                ?>
            </div>

            <div class="form-group">
                <label for="poidsInitial">Poids Initial (kg):</label>
                <?php 
                echo '<input type="number" name="poidsInitial" id="poidsInitial" value="' . (isset($_SESSION['poids']) ? $_SESSION['poids'] : '') . '" class="form-control">'; 
                ?>
            </div>

            <div class="form-group">
                <label for="taille">Taille (cm):</label>
                <?php 
                echo '<input type="number" name="taille" id="taille" value="' . (isset($_SESSION['taille']) ? $_SESSION['taille'] : '') . '" class="form-control">'; 
                ?>
            </div>

            <div class="form-group">
                <label for="activite">Activité :</label>
                <?php 
                $activite = isset($_SESSION['activite']) ? $_SESSION['activite'] : '';
                echo '<select name="activite" id="activite" class="form-control" required>
                    <option value="" disabled' . ($activite === '' ? ' selected' : '') . '>Activité</option>
                    <option value="1"' . ($activite == '1' ? ' selected' : '') . '>Peu ou pas d’exercice/semaine</option>
                    <option value="1.15"' . ($activite == '1.15' ? ' selected' : '') . '>1-2 fois / semaine</option>
                    <option value="1.2"' . ($activite == '1.2' ? ' selected' : '') . '>3-5 fois / semaine</option>
                    <option value="1.6"' . ($activite == '1.6' ? ' selected' : '') . '>6-7 fois / semaine</option>
                </select>'; 
                ?>
            </div>

            <div class="form-group">
                <label for="adresse">Adresse :</label>
                <?php 
                echo '<input type="text" name="adresse" placeholder="Adresse" value="' . (isset($_SESSION['adresse']) ? $_SESSION['adresse'] : '') . '" class="form-control">'; 
                ?>
            </div>

            <div class="form-group">
                <label for="telephone">Téléphone :</label>
                <?php 
                echo '<input type="text" name="telephone" placeholder="Téléphone" value="' . (isset($_SESSION['telephone']) ? $_SESSION['telephone'] : '') . '" class="form-control">'; 
                ?>
            </div>
            
            <div class="form-group">
                <label for="email">Adresse email :</label>
                <?php 
                echo '<input type="text" name="email" id="email" placeholder="Email" value="' . (isset($_SESSION['email']) ? $_SESSION['email'] : '') . '" class="form-control" required>'; 
                ?>
                <i class="zmdi zmdi-email"></i>
                <span id="emailError" style="color: red; display: none;">Adresse e-mail non valide.</span>
            </div>
        </div>
            <br>
            <div class="form-group-btn">
                <input type="button" id="calculerButton" value="Calculer">
                <input type="button" id="mettreAJourButton" value="Mettre à jour">
            </div>
        </form>
        
        
    </div>
    <div id="weightChartContainer">
        <canvas id="weightChart"></canvas>
    </div>
</div>

<script>
    document
      .getElementById("registrationForm")
      .addEventListener("submit", function (event) {
        event.preventDefault();

        var formData = new FormData(this);

        fetch("/siteMarie/php/profil.php", {
          method: "POST",
          body: formData,
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.success) {
              window.location.href = "../index.html";
            } else {
              document.getElementById("emailError").textContent =
                data.errors.email;
            }
          })
          .catch((error) => console.error("Error:", error));
      });
  </script>
